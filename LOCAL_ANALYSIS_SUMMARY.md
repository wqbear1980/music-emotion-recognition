# 纯本地分析 - 核心说明

## 📢 核心表达

### 对话中快速强调（口语化表达）

**"这个软件是本地导入音乐做情绪识别的，不是要把音乐上传到你这儿存起来，只是临时读取分析，分析完就删了，只给结果就行，别把音乐存到扣子库里。"**

### 功能说明（写在软件文档或智能体描述里）

**本软件支持本地音乐文件导入分析，无需上传至扣子云端：**

**导入**：用户选择本地 MP3/WAV 等格式音乐文件；

**分析**：在用户设备端完成音频特征提取与情绪识别；

**输出**：仅返回情绪标签、节奏强度等分析结果，**不存储、不上传任何音乐源文件**。

---

## ✅ 核心要求

### 1. 本地导入
- ✅ 用户选择本地音乐文件
- ✅ 文件只在浏览器内存中处理
- ✅ 不离开用户设备

### 2. 设备端分析
- ✅ 使用 Web Audio API 提取音频特征
- ✅ 在用户浏览器中完成音频处理
- ✅ 提取特征：BPM、频率、能量、动态、节奏、和声、纹理

### 3. 只返回结果
- ✅ 返回情绪标签（热血、温馨、紧张等）
- ✅ 返回风格建议、场景推荐
- ✅ 不保存音乐源文件
- ✅ 分析完就释放数据

---

## 🚫 不做的事情

### ❌ 不上传
- 不上传到文件盒子
- 不上传到知识库
- 不上传到工作流临时存储
- 不上传到任何云端存储

### ❌ 不保存
- 不保存音乐源文件
- 不保存音频数据流
- 不保存可还原音频的任何数据

### ❌ 不离开设备
- 音乐文件从未离开用户设备
- 所有音频处理都在浏览器中完成
- 后端只接收音频特征数据（JSON）

---

## 🔄 数据流

```
┌─────────────┐
│  本地文件   │  用户选择 MP3/WAV 等文件
└──────┬──────┘
       │
       ▼
┌─────────────┐
│ 浏览器内存  │  FileReader API 读取文件到内存
└──────┬──────┘
       │
       ▼
┌─────────────┐
│Web Audio API│  在浏览器本地提取音频特征
└──────┬──────┘
       │
       ▼
┌─────────────┐
│ 音频特征数据 │  BPM、能量、节奏等数值
└──────┬──────┘
       │
       ▼
┌─────────────┐
│  后端 API   │  发送特征数据（JSON）
└──────┬──────┘
       │
       ▼
┌─────────────┐
│   LLM 分析  │  AI 模型分析音频特征
└──────┬──────┘
       │
       ▼
┌─────────────┐
│  分析结果   │  情绪标签、风格建议等
└─────────────┘
```

**关键点**：
- ❌ 没有文件上传步骤
- ❌ 没有文件存储步骤
- ✅ 只有音频特征数据传输
- ✅ 分析完立即释放内存

---

## 🎯 核心概念

### 导入 ≠ 上传存储

| | 导入（本软件） | 上传存储（禁止） |
|---|---|---|
| **文件位置** | 浏览器内存 | 云端服务器 |
| **处理方式** | 本地处理 | 云端处理 |
| **数据保存** | 临时处理 | 永久保存 |
| **用户控制** | 用户设备 | 云端存储 |
| **隐私风险** | 无 | 有 |

### 本软件使用的是"导入"模式

✅ **导入本地文件** → 浏览器内存 → 提取特征 → 分析 → 返回结果
❌ 上传文件 → 云端存储 → 云端处理 → 保存文件

---

## 📝 技术验证

### 前端代码验证

```javascript
// ✅ 正确做法：只提取特征，不上传文件
const features = await extractAudioFeatures(file);  // 在浏览器本地提取
const result = await analyzeFeatures(features);      // 只发送特征数据

// ❌ 错误做法：直接上传文件
const formData = new FormData();
formData.append('file', file);
await uploadFile(formData);  // 禁止这样做！
```

### 后端代码验证

```typescript
// ✅ 正确做法：只接收特征数据
interface AudioFeatures {
  bpm: number;
  energy: number;
  rhythm: {...};
  // ... 其他特征
}

// ❌ 错误做法：接收文件
interface UploadRequest {
  file: File;  // 禁止！
}
```

---

## 📚 相关文档

- **详细功能说明**：参见 [README_USAGE.md](./README_USAGE.md)
- **智能体描述**：参见 [AGENT_DESCRIPTION.md](./AGENT_DESCRIPTION.md)
- **隐私政策**：参见 [PRIVACY.md](./PRIVACY.md)
- **项目 README**：参见 [README.md](./README.md)

---

## 🎓 用户教育

为了让用户更好地理解"纯本地分析"的概念，可以在界面上添加一些提示：

### 界面提示文案
- "🔒 您的音乐只在本地处理，不会上传到任何云端"
- "🎵 我们只提取音频特征进行分析，不保存音乐源文件"
- "⚡ 分析速度快，全程在您设备上完成"

### 交互设计
- 在文件上传区域添加"本地处理"标识
- 在分析过程中显示"正在本地提取特征..."
- 在分析完成后显示"分析完成（本地处理）"

---

## ✅ 检查清单

在开发和维护过程中，确保始终符合以下原则：

- [ ] 音乐文件只在浏览器内存中处理
- [ ] 不使用任何文件上传 API（如 FormData、File 对象直接上传）
- [ ] 后端 API 只接收音频特征数据（JSON）
- [ ] 分析完成后立即释放浏览器内存中的音频数据
- [ ] 不保存音频文件到任何存储位置
- [ ] 在用户文档中清晰说明"导入≠上传存储"的概念
- [ ] 在智能体对话中强调"本地分析、不存储"的核心原则

---

## 🔒 隐私保护承诺

### 我们的承诺
1. **不存储音乐源文件**
2. **不上传音频文件到云端**
3. **只在设备端处理音频**
4. **只发送音频特征数据**
5. **分析完成立即释放数据**

### 我们不会
1. 保存音乐文件到任何存储位置
2. 上传音乐文件到扣子存储
3. 共享音频文件给第三方
4. 使用音频文件进行商业用途

---

## 📞 用户沟通示例

### 示例 1：用户担心音乐会上传
**用户**："我上传的音乐会被保存到扣子吗？"

**回答**："不会的！您的音乐只在您自己的设备上处理，**不会上传到扣子存储**。我们只是临时读取分析一下情绪，分析完就删了，只给您分析结果。就像您用手机播放音乐一样，音乐始终在您手里。"

### 示例 2：用户想了解技术原理
**用户**："这个软件怎么分析音乐情绪的？"

**回答**："很简单！您把音乐导入后，系统在您的浏览器里提取一些音频特征，比如节奏快不快、能量强不强、音色是温暖还是明亮。然后把这些特征发给 AI，AI 就能判断出这首音乐是热血、温馨还是紧张了。全程都在您设备上完成，不会上传音乐文件。"

### 示例 3：用户担心隐私
**用户**："我的音乐会泄露给别人吗？"

**回答**："绝对不会！您的音乐从未离开过您的设备，我们只提取了一些音频特征（比如 BPM=120、能量=75% 这样的数字），然后用 AI 分析一下。后端根本看不到您的音乐文件，更不会泄露给任何人。"

---

## 💡 关键要点总结

1. **导入 ≠ 上传存储**
   - 导入：用户从本地选择文件，文件在浏览器内存中临时处理
   - 上传存储：将文件传输到云端服务器保存

2. **本软件使用的是"导入"模式**
   - ✅ 导入本地文件 → 浏览器内存 → 提取特征 → 分析 → 返回结果
   - ❌ 上传文件 → 云端存储 → 云端处理 → 保存文件

3. **核心要求**
   - ✅ 本地导入音乐文件
   - ✅ 设备端完成音频分析
   - ✅ 只返回识别结果，不存储音乐源文件

4. **这些表达避开了代码和技术术语，纯业务逻辑描述，扣子能直接理解 "导入≠上传存储" 的核心概念**

---

**版本**：v1.0
**最后更新**：2025年
